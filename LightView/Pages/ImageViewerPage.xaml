<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="LightView.Pages.ImageViewerPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:LightView.Pages"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:LightView.Models"
    mc:Ignorable="d">

    <Grid>
        <Grid
            x:Name="TitleBarHost"
            Height="48"
            VerticalAlignment="Top"
            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
            BorderThickness="1"
            Canvas.ZIndex="99">
            <Grid.Background>
                <AcrylicBrush
                    FallbackColor="Transparent"
                    TintColor="Transparent"
                    TintOpacity="0.6" />
            </Grid.Background>
            <TitleBar
                x:Name="TitleBar"
                Title="{x:Bind ViewModel.CurrentImage.Name, Mode=OneWay}"
                Height="48"
                VerticalAlignment="Top"
                BackRequested="TitleBar_BackRequested"
                Canvas.ZIndex="1"
                IsBackButtonVisible="True"
                Subtitle="{x:Bind ViewModel.DisplayInfo, Mode=OneWay}">
                <TitleBar.RightHeader>
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Button
                            x:Name="SettingsButton"
                            Click="SettingsButton_Click"
                            Style="{ThemeResource TitleBarButtonStyle}">
                            <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE713;" />
                        </Button>
                        <Button x:Name="MenuButton" Style="{ThemeResource TitleBarButtonStyle}">
                            <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE712;" />
                            <Button.Flyout>
                                <MenuFlyout>
                                    <MenuFlyoutItem Command="{x:Bind ViewModel.ShareImageCommand, Mode=OneWay}" Text="分享照片">
                                        <MenuFlyoutItem.Icon>
                                            <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE72D;" />
                                        </MenuFlyoutItem.Icon>
                                    </MenuFlyoutItem>
                                    <MenuFlyoutItem Command="{x:Bind ViewModel.PrintImageCommand, Mode=OneWay}" Text="打印照片">
                                        <MenuFlyoutItem.Icon>
                                            <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE749;" />
                                        </MenuFlyoutItem.Icon>
                                    </MenuFlyoutItem>
                                </MenuFlyout>
                            </Button.Flyout>
                        </Button>
                    </StackPanel>
                </TitleBar.RightHeader>
            </TitleBar>
        </Grid>

        <ScrollView ZoomMode="Enabled">
            <Image x:Name="ImageViewer" Source="{x:Bind ViewModel.CurrentImage.ImageSource, Mode=OneWay}" />
        </ScrollView>
        <Border
            Height="118"
            MinWidth="256"
            Margin="16"
            HorizontalAlignment="Center"
            VerticalAlignment="Bottom"
            Background="{ThemeResource SystemControlAcrylicElementMediumHighBrush}"
            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
            BorderThickness="1"
            CornerRadius="{ThemeResource OverlayCornerRadius}">

            <ItemsView
                Margin="4"
                IsItemInvokedEnabled="True"
                ItemInvoked="ItemsView_ItemInvoked"
                ItemsSource="{x:Bind ViewModel.FolderImages, Mode=OneWay}">
                <ItemsView.Layout>
                    <StackLayout Orientation="Horizontal" />
                </ItemsView.Layout>
                <ItemsView.ItemTemplate>
                    <DataTemplate x:DataType="models:ImageModel">
                        <ItemContainer>
                            <StackPanel
                                Margin="5"
                                Orientation="Vertical"
                                ToolTipService.ToolTip="{x:Bind Name}">
                                <Image
                                    Width="108"
                                    Height="96"
                                    Source="{x:Bind ImageSource}"
                                    Stretch="UniformToFill" />
                            </StackPanel>
                        </ItemContainer>
                    </DataTemplate>
                </ItemsView.ItemTemplate>
            </ItemsView>
        </Border>
    </Grid>
</Page>
